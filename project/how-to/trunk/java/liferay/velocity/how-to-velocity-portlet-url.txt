

ThemeDisplay themeDisplay = (ThemeDisplay) request.getAttribute(WebKeys.THEME_DISPLAY);
Layout layout = LayoutLocalServiceUtil.getFriendlyURLLayout(themeDisplay.getScopeGroupId(), false, pageName);
HttpServletRequest httpRequest = PortalUtil.getHttpServletRequest(request); 
httpRequest = PortalUtil.getOriginalServletRequest(httpRequest);
portletURL = PortletURLFactoryUtil.create(httpRequest , portletId, layout.getPlid() , PortletRequest.RENDER_PHASE); 
portletURL.setWindowState(WindowState.NORMAL);
portletURL.setPortletMode(PortletMode.VIEW);


#set ($catLocalService = $serviceLocator.findService("com.liferay.portlet.asset.service.AssetCategoryLocalService"))

#set ($createEventFriendlyUrl = $propsUtil.get("estim.page.accueil.url"))

#set($createEventLayout = $layoutLocalServiceUtil.getFriendlyURLLayout($themeDisplay.getScopeGroupId(), false, $propsUtil.get("estim.create.event.friendly.url")))
#set ($createGPEventURL = $portletURLFactory.create($request, "gestionevenement_WAR_estimportailportlet",$createEventLayout.getPlid(), "RENDER_PHASE"))
$createGPEventURL.setParameter("myaction","createEvent") 
$createGPEventURL.setParameter("typeEvent","GP") 
$createGPEventURL.setPortletMode(PortletMode.VIEW)

#set ($createAccountUrl = $portletURLFactory.create($request, "58", $page.getPlid(), "ACTION_PHASE"))
2$createAccountUrl.setWindowState(WindowState.MAXIMIZED)
3$createAccountUrl.setParameter("struts_action", "/login/create_account")
4$createAccountUrl.setPortletMode(PortletMode.VIEW)
5$createAccountUrl.setParameter("saveLastPath", "0")