<%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %>
<%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %>
<%@ taglib uri="/WEB-INF/struts-logic.tld" prefix="logic" %>
<%@ taglib uri="/WEB-INF/struts-tiles.tld" prefix="tiles" %>
<%@ taglib uri="/WEB-INF/citedessciences.tld" prefix="csi"%>
<html:form action="/SauvFicheExploitation" styleClass="formList" enctype="multipart/form-data">
<html:hidden property="id" name="EditerFicheExploitationForm" />
<html:hidden property="ficheReservationLiee" name="EditerFicheExploitationForm" />
<html:hidden property="ficheAnnuleeRemplacante" name="EditerFicheExploitationForm" />
<html:errors/>
<table class="formList">
	<tr>
		<th><csi:Title 	key="formfiche.titre.chefprojet" /></th>
		<td>
			<logic:notEmpty name="selectchefprojet">
				<logic:equal value="true" name="selectchefprojet">
					<csi:UserSelect size="8"
								property="chefprojet" 
								name="EditerFicheExploitationForm" 
								roleId="4" />
				</logic:equal>
			</logic:notEmpty>
			<logic:empty name="selectchefprojet">
				<logic:notEqual value="true" name="selectchefprojet">
					<bean:write name="fiche" property="chefDeProjet"/>
				</logic:notEqual>
			</logic:empty>
		 </td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.titre.operation" 
						mandatory="true" /></th>
		<td><csi:Text 	property="titreOperation" 
						name="EditerFicheExploitationForm" styleClass="longfield"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.numeroCCV" 
						mandatory="false" /></th>
		<td><csi:Text 	property="numeroCCV" 
						name="EditerFicheExploitationForm" 
						maxlength="255"
						styleClass="longfield"/></td>
    </tr>    
    <tr>
		<th><csi:Title 	key="formfiche.titre.titre.court" 
						mandatory="true" /></th>
		<td><csi:Text 	property="titreCourt" 
						name="EditerFicheExploitationForm"
						labelKey="label.maxlength.titrecourt" styleClass="longfield"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.type.operation" 
						mandatory="true" /></th>
		<td><csi:TypeOp	property="typeOperation" 
						name="EditerFicheExploitationForm" 
						size="0"
						onchange="deleteVisasComplementaire('document.forms.EditerFicheExploitationForm','typeOperation','visasComplementaires','type');getVisasComplementaires('document.forms.EditerFicheExploitationForm','typeOperation','visasComplementaires','type')"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.type.operationcom" mandatory="true" /></th>
		<td><csi:TypeOpCom	property="typeOperationCom" 
						name="EditerFicheExploitationForm" 
						size="0"/></td>
    </tr>    
    <tr>
		<th><csi:Title 	key="formfiche.titre.resume" 
						mandatory="true" /></th>
		<td><csi:TextArea property="resume"
						  name="EditerFicheExploitationForm"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.deroulement" /></th>
		<td><csi:TextArea property="deroulement"
						  name="EditerFicheExploitationForm"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.consequences" /></th>
		<td><csi:TextArea property="consequences"
						  name="EditerFicheExploitationForm"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.observation" /></th>
		<td><csi:TextArea property="observation"
						  name="EditerFicheExploitationForm"/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.lieu.geographique" 
						mandatory="true" />
		</th>
    	<td>
 			<csi:SelectLieuGeo 
				property="lieuGeo"
				name="EditerFicheExploitationForm" 
				size="6"
				preAddJS="getVisasComplementaires('document.forms.EditerFicheExploitationForm','lieugeoLieu','visasComplementaires','lieuGeo')"
				preSuppJS="deleteVisasComplementaire('document.forms.EditerFicheExploitationForm','lieuGeo','visasComplementaires','lieuGeo')"
			/>   	
    	</td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.date" 
						mandatory="true" /></th>
		<td><csi:DatePeriodeMulti 	name="EditerFicheExploitationForm" 
									property="dates" 
									size="8"
									calendarPicture="calend.gif"/> </td>
    </tr>
     <logic:equal name="userenv" property="chefDepartementNotRequired" value="false" scope="session">
    <tr>
		<th><csi:Title 	key="formfiche.chef.departement" 
						mandatory="true" /></th>
		<td><csi:UserSelect size="8" 
							property="chefDepartement" 
							name="EditerFicheExploitationForm" 
							roleId="10" 
							displayInput="false" /></td>
    </tr>
    </logic:equal>
    <logic:equal name="userenv" property="chefDepartementNotRequired" value="true" scope="session">
    	<html:hidden property="chefDepartement" name="EditerFicheExploitationForm" value="-1"/>
    </logic:equal>
    <logic:equal name="userenv" property="directeurNotRequired" value="false" scope="session">
    <tr>
		<th><csi:Title 	key="formfiche.directeur" 
						mandatory="true" /></th>
		<td><csi:UserSelect size="8" 
							property="directeurDepartement" 
							name="EditerFicheExploitationForm" 
							roleId="3" 
							displayInput="false" /></td>
    </tr>
    </logic:equal>
    <logic:equal name="userenv" property="directeurNotRequired" value="true" scope="session">
    	<html:hidden property="directeurDepartement" name="EditerFicheExploitationForm" value="-1"/>
    </logic:equal>
    <tr>
    	<th><csi:Title 	key="formfiche.visas.obligatoire" 
						mandatory="false" /></th>
		<td>
			<logic:iterate id="categorie" name="fiche" property="categorieVisaObligatoire">
	    		<div><bean:write name="categorie" property="libelle"/></div>
		    	<logic:iterate id="visa" name="categorie" property="acteurBeanList">
		    		<div class="acteurNoAction"><bean:write name="visa" property="nom"/>&nbsp;<bean:write name="visa" property="prenom"/>&nbsp;
		    		<logic:present name="visa" property="tel">
		    			<logic:present name="visa" property="secteur">
				    		(<bean:write name="visa" property="secteur"/>&nbsp;-&nbsp;<bean:write name="visa" property="tel"/>)
			    		</logic:present>
			    		<logic:notPresent name="visa" property="secteur">
			    			(<bean:write name="visa" property="tel"/>)
			    		</logic:notPresent>
		    		</logic:present>
		    		<logic:notPresent name="visa" property="tel">
		    			<logic:present name="visa" property="secteur">
				    		(<bean:write name="visa" property="secteur"/>)
			    		</logic:present>
					</logic:notPresent>
		    		</div>
				</logic:iterate>
		    </logic:iterate>
    	</td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.visas.complementaire" 
						mandatory="false" /></th>
		<td><csi:MultiSelectUser size="8" 
							property="visasComplementaires" 
							name="EditerFicheExploitationForm"
							multiple="true"
							roleId="2"
							preSuppJS="checkBesoinSpecifique('document.forms.EditerFicheExploitationForm','visasComplementaires')"
			/></td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.titre.besoin.specifique" /></th>
		<td><csi:MultiBesoinSelect 	size="8" 
									property="besoinsSpecifiques" 
									name="EditerFicheExploitationForm"
									preAddJS="getVisasComplementaires('document.forms.EditerFicheExploitationForm','besoinsSpecifiques','visasComplementaires','besoin')"
									preSuppJS="deleteVisasComplementaire('document.forms.EditerFicheExploitationForm','besoinsSpecifiques','visasComplementaires','besoin')"/> </td>
    </tr>
    <tr>
		<th><csi:Title 	key="formfiche.visas.documents.joints" /></th>
		<td><csi:DocumentJoint name="EditerFicheExploitationForm" property="documents"/></td>
    </tr>
    <tr style="display: none">
	    <td colspan="2">
			<csi:SelectVisas name="EditerFicheExploitationForm" property="associationsVisas"/>
			
    	</td>
    </tr>
    <tr>
    	<th>
    		<csi:Title key="formfiche.nuisances" />
    	</th>
    	<td>
    		<csi:MultiSelectNuisances name="EditerFicheExploitationForm" property="nuisances" size="6" multiple="true"></csi:MultiSelectNuisances>
    	</td>
    </tr>
    
    <!-- ajout du commentaire -->
    
 
</table>
<html:javascript formName="EditerFicheExploitationForm"/>
</html:form>